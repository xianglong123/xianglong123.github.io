<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JVM 基础 - Java 内存模型引入 | 个人主页</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/images/photo.jpg">
    <link rel="manifest" href="/images/photo.jpg">
    <link rel="apple-touch-icon" href="/images/photo.jpg">
    <meta name="description" content="Personal Website">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/assets/css/0.styles.cfd1e9a2.css" as="style"><link rel="preload" href="/assets/js/app.0d6df2e4.js" as="script"><link rel="preload" href="/assets/js/3.2c60df78.js" as="script"><link rel="preload" href="/assets/js/16.9a65883a.js" as="script"><link rel="prefetch" href="/assets/js/10.a675ef31.js"><link rel="prefetch" href="/assets/js/100.c1d0cb0f.js"><link rel="prefetch" href="/assets/js/101.c3caeaf7.js"><link rel="prefetch" href="/assets/js/102.c33f1aeb.js"><link rel="prefetch" href="/assets/js/103.eddf2e86.js"><link rel="prefetch" href="/assets/js/104.943ce33b.js"><link rel="prefetch" href="/assets/js/105.d04687f0.js"><link rel="prefetch" href="/assets/js/106.2dfd0540.js"><link rel="prefetch" href="/assets/js/107.d0139f1c.js"><link rel="prefetch" href="/assets/js/108.24c68d63.js"><link rel="prefetch" href="/assets/js/109.a88c2829.js"><link rel="prefetch" href="/assets/js/11.561f08ee.js"><link rel="prefetch" href="/assets/js/110.ec9d9c92.js"><link rel="prefetch" href="/assets/js/111.a37b7b9f.js"><link rel="prefetch" href="/assets/js/112.862950f9.js"><link rel="prefetch" href="/assets/js/113.bf489717.js"><link rel="prefetch" href="/assets/js/114.0569b17d.js"><link rel="prefetch" href="/assets/js/115.cf784dec.js"><link rel="prefetch" href="/assets/js/116.92c16b65.js"><link rel="prefetch" href="/assets/js/117.991782bd.js"><link rel="prefetch" href="/assets/js/12.e4c2aa4a.js"><link rel="prefetch" href="/assets/js/13.35f9ed5a.js"><link rel="prefetch" href="/assets/js/14.b7f6f87c.js"><link rel="prefetch" href="/assets/js/15.808b42c3.js"><link rel="prefetch" href="/assets/js/17.dbfc7bb2.js"><link rel="prefetch" href="/assets/js/18.c329e942.js"><link rel="prefetch" href="/assets/js/19.83deeff3.js"><link rel="prefetch" href="/assets/js/2.40aa7bb6.js"><link rel="prefetch" href="/assets/js/20.bdd777c1.js"><link rel="prefetch" href="/assets/js/21.b486bbf9.js"><link rel="prefetch" href="/assets/js/22.a25a903b.js"><link rel="prefetch" href="/assets/js/23.925ff4e0.js"><link rel="prefetch" href="/assets/js/24.ceff7a46.js"><link rel="prefetch" href="/assets/js/25.760d6451.js"><link rel="prefetch" href="/assets/js/26.66b0e693.js"><link rel="prefetch" href="/assets/js/27.79296467.js"><link rel="prefetch" href="/assets/js/28.6f5b92df.js"><link rel="prefetch" href="/assets/js/29.f2b1ce52.js"><link rel="prefetch" href="/assets/js/30.3bafedc7.js"><link rel="prefetch" href="/assets/js/31.b967adc4.js"><link rel="prefetch" href="/assets/js/32.bfcba426.js"><link rel="prefetch" href="/assets/js/33.c838af1a.js"><link rel="prefetch" href="/assets/js/34.6f70f963.js"><link rel="prefetch" href="/assets/js/35.40935f03.js"><link rel="prefetch" href="/assets/js/36.bcf1bbbf.js"><link rel="prefetch" href="/assets/js/37.48e1a430.js"><link rel="prefetch" href="/assets/js/38.82997478.js"><link rel="prefetch" href="/assets/js/39.77436fc0.js"><link rel="prefetch" href="/assets/js/4.7d10bedd.js"><link rel="prefetch" href="/assets/js/40.bc3182ae.js"><link rel="prefetch" href="/assets/js/41.71103288.js"><link rel="prefetch" href="/assets/js/42.7690245a.js"><link rel="prefetch" href="/assets/js/43.d2d3d553.js"><link rel="prefetch" href="/assets/js/44.3f350618.js"><link rel="prefetch" href="/assets/js/45.97083dfb.js"><link rel="prefetch" href="/assets/js/46.a41e95bb.js"><link rel="prefetch" href="/assets/js/47.8540ef07.js"><link rel="prefetch" href="/assets/js/48.54629455.js"><link rel="prefetch" href="/assets/js/49.5f90d180.js"><link rel="prefetch" href="/assets/js/5.b88ed74c.js"><link rel="prefetch" href="/assets/js/50.7fa4c3a4.js"><link rel="prefetch" href="/assets/js/51.6ebb146b.js"><link rel="prefetch" href="/assets/js/52.fe6e9396.js"><link rel="prefetch" href="/assets/js/53.fa23c041.js"><link rel="prefetch" href="/assets/js/54.90582436.js"><link rel="prefetch" href="/assets/js/55.b8844963.js"><link rel="prefetch" href="/assets/js/56.5fd08d82.js"><link rel="prefetch" href="/assets/js/57.d57125ff.js"><link rel="prefetch" href="/assets/js/58.0696d91e.js"><link rel="prefetch" href="/assets/js/59.cf936091.js"><link rel="prefetch" href="/assets/js/6.d4fec8b7.js"><link rel="prefetch" href="/assets/js/60.e0404bbf.js"><link rel="prefetch" href="/assets/js/61.fd7b24c0.js"><link rel="prefetch" href="/assets/js/62.bab35282.js"><link rel="prefetch" href="/assets/js/63.bc3aab78.js"><link rel="prefetch" href="/assets/js/64.5f1bfff1.js"><link rel="prefetch" href="/assets/js/65.c431a11a.js"><link rel="prefetch" href="/assets/js/66.e2d06bb1.js"><link rel="prefetch" href="/assets/js/67.32853338.js"><link rel="prefetch" href="/assets/js/68.342b04c0.js"><link rel="prefetch" href="/assets/js/69.a1ce55b6.js"><link rel="prefetch" href="/assets/js/7.3197ebba.js"><link rel="prefetch" href="/assets/js/70.496c0997.js"><link rel="prefetch" href="/assets/js/71.31b35f4d.js"><link rel="prefetch" href="/assets/js/72.62ea27e4.js"><link rel="prefetch" href="/assets/js/73.2c961c77.js"><link rel="prefetch" href="/assets/js/74.8dbb42b8.js"><link rel="prefetch" href="/assets/js/75.f80b5005.js"><link rel="prefetch" href="/assets/js/76.07020749.js"><link rel="prefetch" href="/assets/js/77.930e3bad.js"><link rel="prefetch" href="/assets/js/78.fc6f0094.js"><link rel="prefetch" href="/assets/js/79.c72fd757.js"><link rel="prefetch" href="/assets/js/8.6e794918.js"><link rel="prefetch" href="/assets/js/80.8c9694ec.js"><link rel="prefetch" href="/assets/js/81.383d5cfc.js"><link rel="prefetch" href="/assets/js/82.1253ca4a.js"><link rel="prefetch" href="/assets/js/83.f0ff7a4d.js"><link rel="prefetch" href="/assets/js/84.5910af60.js"><link rel="prefetch" href="/assets/js/85.a9330cf0.js"><link rel="prefetch" href="/assets/js/86.e4b0497e.js"><link rel="prefetch" href="/assets/js/87.664f4a10.js"><link rel="prefetch" href="/assets/js/88.69b05471.js"><link rel="prefetch" href="/assets/js/89.4f1a869b.js"><link rel="prefetch" href="/assets/js/9.94dfd66d.js"><link rel="prefetch" href="/assets/js/90.91a54f02.js"><link rel="prefetch" href="/assets/js/91.cfe61516.js"><link rel="prefetch" href="/assets/js/92.99f20c42.js"><link rel="prefetch" href="/assets/js/93.dea260f7.js"><link rel="prefetch" href="/assets/js/94.4d34f33a.js"><link rel="prefetch" href="/assets/js/95.1977d5c8.js"><link rel="prefetch" href="/assets/js/96.07bc7add.js"><link rel="prefetch" href="/assets/js/97.548d05ca.js"><link rel="prefetch" href="/assets/js/98.3e689473.js"><link rel="prefetch" href="/assets/js/99.3382c108.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cfd1e9a2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人主页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java面向对象和基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/basic/java-basic-oop.html" class="nav-link">
  Java基础-面向对象
</a></li><li class="dropdown-subitem"><a href="/md/java/basic/java-basic-lan-basic.html" class="nav-link">
  Java基础-知识点
</a></li><li class="dropdown-subitem"><a href="/md/java/basic/java-basic-lan-sum.html" class="nav-link">
  Java 基础 - 图谱 &amp; Q/A
</a></li></ul></li><li class="dropdown-item"><h4>
          Java集合框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/collection/java-collection-all.html" class="nav-link">
  Java 集合框架详解
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶 - 并发框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/thread/java-thread-x-overview.html" class="nav-link">
  Java 并发知识体系
</a></li><li class="dropdown-subitem"><a href="/md/java/thread/java-thread-x-theorty.html" class="nav-link">
  Java 并发理论基础
</a></li><li class="dropdown-subitem"><a href="/md/java/thread/java-thread-x-thread-basic.html" class="nav-link">
  Java 并发线程基础
</a></li><li class="dropdown-subitem"><a href="/md/java/thread/java-thread-x-juc-overview.html" class="nav-link">
  J.U.C 知识体系与详解
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶 - IO框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/io/java-io-overview.html" class="nav-link">
  Java IO/NIO/AIO详解
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶 - 新版本特性
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/java8/java8.html" class="nav-link">
  Java 8 特性详解
</a></li><li class="dropdown-subitem"><a href="/md/java/java8up/java-8-up-overview.html" class="nav-link">
  Java 8 以上版本特性体系
</a></li><li class="dropdown-subitem"><a href="/md/java/java8up/java9-11.html" class="nav-link">
  Java 8 升Java 11特性必读
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶 - JVM相关
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-classload.html" class="nav-link">
  Java 类加载机制
</a></li><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-class.html" class="nav-link">
  Java 字节码和增强技术
</a></li><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-struct.html" class="nav-link">
  JVM 内存结构详解
</a></li><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-gc.html" class="nav-link">
  JVM 垃圾回收机制
</a></li><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-debug-tools-linux.html" class="nav-link">
  Java 调试排错相关
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据库相关介绍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/db/info/mysql.html" class="nav-link">
  mysql
</a></li><li class="dropdown-subitem"><a href="/md/db/info/oracle.html" class="nav-link">
  oracle
</a></li><li class="dropdown-subitem"><a href="/md/db/info/h2.html" class="nav-link">
  h2
</a></li></ul></li><li class="dropdown-item"><h4>
          框架介绍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/db/frame/mybatis/mybatis-base-overview.html" class="nav-link">
  mybatis
</a></li><li class="dropdown-subitem"><a href="/md/db/frame/mp/mp-base-overview.html" class="nav-link">
  mybatis-plus
</a></li><li class="dropdown-subitem"><a href="/md/db/frame/jpa/jpa-base-overview.html" class="nav-link">
  jpa
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          redis
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/middleware/redis/redis-overview.html" class="nav-link">
  redis各大版本
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人记录" class="dropdown-title"><span class="title">个人记录</span> <span class="arrow down"></span></button> <button type="button" aria-label="个人记录" class="mobile-dropdown-title"><span class="title">个人记录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          2024
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/owner/2024/229-1.html" class="nav-link">
  vuepress打包报unsupported
</a></li><li class="dropdown-subitem"><a href="/md/owner/2024/229-2.html" class="nav-link">
  待定
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/xianglong123/cas-blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java面向对象和基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/basic/java-basic-oop.html" class="nav-link">
  Java基础-面向对象
</a></li><li class="dropdown-subitem"><a href="/md/java/basic/java-basic-lan-basic.html" class="nav-link">
  Java基础-知识点
</a></li><li class="dropdown-subitem"><a href="/md/java/basic/java-basic-lan-sum.html" class="nav-link">
  Java 基础 - 图谱 &amp; Q/A
</a></li></ul></li><li class="dropdown-item"><h4>
          Java集合框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/collection/java-collection-all.html" class="nav-link">
  Java 集合框架详解
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶 - 并发框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/thread/java-thread-x-overview.html" class="nav-link">
  Java 并发知识体系
</a></li><li class="dropdown-subitem"><a href="/md/java/thread/java-thread-x-theorty.html" class="nav-link">
  Java 并发理论基础
</a></li><li class="dropdown-subitem"><a href="/md/java/thread/java-thread-x-thread-basic.html" class="nav-link">
  Java 并发线程基础
</a></li><li class="dropdown-subitem"><a href="/md/java/thread/java-thread-x-juc-overview.html" class="nav-link">
  J.U.C 知识体系与详解
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶 - IO框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/io/java-io-overview.html" class="nav-link">
  Java IO/NIO/AIO详解
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶 - 新版本特性
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/java8/java8.html" class="nav-link">
  Java 8 特性详解
</a></li><li class="dropdown-subitem"><a href="/md/java/java8up/java-8-up-overview.html" class="nav-link">
  Java 8 以上版本特性体系
</a></li><li class="dropdown-subitem"><a href="/md/java/java8up/java9-11.html" class="nav-link">
  Java 8 升Java 11特性必读
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶 - JVM相关
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-classload.html" class="nav-link">
  Java 类加载机制
</a></li><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-class.html" class="nav-link">
  Java 字节码和增强技术
</a></li><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-struct.html" class="nav-link">
  JVM 内存结构详解
</a></li><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-gc.html" class="nav-link">
  JVM 垃圾回收机制
</a></li><li class="dropdown-subitem"><a href="/md/java/jvm/java-jvm-debug-tools-linux.html" class="nav-link">
  Java 调试排错相关
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据库相关介绍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/db/info/mysql.html" class="nav-link">
  mysql
</a></li><li class="dropdown-subitem"><a href="/md/db/info/oracle.html" class="nav-link">
  oracle
</a></li><li class="dropdown-subitem"><a href="/md/db/info/h2.html" class="nav-link">
  h2
</a></li></ul></li><li class="dropdown-item"><h4>
          框架介绍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/db/frame/mybatis/mybatis-base-overview.html" class="nav-link">
  mybatis
</a></li><li class="dropdown-subitem"><a href="/md/db/frame/mp/mp-base-overview.html" class="nav-link">
  mybatis-plus
</a></li><li class="dropdown-subitem"><a href="/md/db/frame/jpa/jpa-base-overview.html" class="nav-link">
  jpa
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          redis
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/middleware/redis/redis-overview.html" class="nav-link">
  redis各大版本
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人记录" class="dropdown-title"><span class="title">个人记录</span> <span class="arrow down"></span></button> <button type="button" aria-label="个人记录" class="mobile-dropdown-title"><span class="title">个人记录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          2024
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/owner/2024/229-1.html" class="nav-link">
  vuepress打包报unsupported
</a></li><li class="dropdown-subitem"><a href="/md/owner/2024/229-2.html" class="nav-link">
  待定
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/xianglong123/cas-blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java 基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/basic/java-basic-oop.html" class="sidebar-link">Java 基础 - 面向对象</a></li><li><a href="/md/java/basic/java-basic-lan-basic.html" class="sidebar-link">Java 基础 - 知识点</a></li><li><a href="/md/java/basic/java-basic-lan-sum.html" class="sidebar-link">Java 基础 - 图谱 &amp; Q/A</a></li><li><a href="/md/java/basic/java-basic-x-generic.html" class="sidebar-link">Java 基础 - 泛型机制详解</a></li><li><a href="/md/java/basic/java-basic-x-exception.html" class="sidebar-link">Java 基础 - 异常机制详解</a></li><li><a href="/md/java/basic/java-basic-x-reflection.html" class="sidebar-link">Java 基础 - 反射机制详解</a></li><li><a href="/md/java/advanced/java-advanced-spi.html" class="sidebar-link">Java常用机制 - SPI机制详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java 集合框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/collection/java-collection-all.html" class="sidebar-link">Collection 类关系图</a></li><li><a href="/md/java/collection/java-collection-ArrayList.html" class="sidebar-link">Collection - ArrayList 源码解析</a></li><li><a href="/md/java/collection/java-collection-LinkedList.html" class="sidebar-link">Collection - LinkedList源码解析</a></li><li><a href="/md/java/collection/java-collection-Queue&amp;Stack.html" class="sidebar-link">Collection - Stack &amp; Queue 源码解析</a></li><li><a href="/md/java/collection/java-collection-PriorityQueue.html" class="sidebar-link">Collection - PriorityQueue源码解析</a></li><li><a href="/md/java/collection/java-map-HashMap&amp;HashSet.html" class="sidebar-link">Map - HashSet &amp; HashMap 源码解析</a></li><li><a href="/md/java/collection/java-map-LinkedHashMap&amp;LinkedHashSet.html" class="sidebar-link">Map - LinkedHashSet&amp;Map源码解析</a></li><li><a href="/md/java/collection/java-map-TreeMap&amp;TreeSet.html" class="sidebar-link">Map - TreeSet &amp; TreeMap 源码解析</a></li><li><a href="/md/java/collection/java-map-WeakHashMap.html" class="sidebar-link">Map - WeakHashMap源码解析</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java 多线程与并发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/thread/java-thread-x-overview.html" class="sidebar-link">♥Java并发知识体系详解♥</a></li><li><a href="/md/java/thread/java-thread-x-theorty.html" class="sidebar-link">Java 并发 - 理论基础</a></li><li><a href="/md/java/thread/java-thread-x-thread-basic.html" class="sidebar-link">Java 并发 - 线程基础</a></li><li><a href="/md/java/thread/java-thread-x-lock-all.html" class="sidebar-link">Java并发 - Java中所有的锁</a></li><li><a href="/md/java/thread/java-thread-x-key-synchronized.html" class="sidebar-link">关键字:synchronized详解</a></li><li><a href="/md/java/thread/java-thread-x-key-volatile.html" class="sidebar-link">关键字:volatile详解</a></li><li><a href="/md/java/thread/java-thread-x-key-final.html" class="sidebar-link">关键字:final详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-overview.html" class="sidebar-link">JUC - 类汇总和学习指南</a></li><li><a href="/md/java/thread/java-thread-x-juc-AtomicInteger.html" class="sidebar-link">JUC原子类CAS, Unsafe和原子类详解</a></li><li><a href="/md/java/thread/java-thread-x-lock-LockSupport.html" class="sidebar-link">JUC锁:LockSupport详解</a></li><li><a href="/md/java/thread/java-thread-x-lock-AbstractQueuedSynchronizer.html" class="sidebar-link">JUC锁:锁核心类AQS详解</a></li><li><a href="/md/java/thread/java-thread-x-lock-ReentrantLock.html" class="sidebar-link">JUC锁:ReentrantLock详解</a></li><li><a href="/md/java/thread/java-thread-x-lock-ReentrantReadWriteLock.html" class="sidebar-link">JUC锁:ReentrantReadWriteLock详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-collection-ConcurrentHashMap.html" class="sidebar-link">JUC集合:ConcurrentHashMap详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-collection-CopyOnWriteArrayList.html" class="sidebar-link">JUC集合:CopyOnWriteArrayList详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-collection-ConcurrentLinkedQueue.html" class="sidebar-link">JUC集合:ConcurrentLinkedQueue详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-collection-BlockingQueue.html" class="sidebar-link">JUC集合:BlockingQueue详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-executor-FutureTask.html" class="sidebar-link">JUC线程池:FutureTask详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-executor-ThreadPoolExecutor.html" class="sidebar-link">JUC线程池:ThreadPoolExecutor详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-executor-ScheduledThreadPoolExecutor.html" class="sidebar-link">JUC线程池:ScheduledThreadPoolExecutor详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-executor-ForkJoinPool.html" class="sidebar-link">JUC线程池:Fork/Join框架详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-tool-countdownlatch.html" class="sidebar-link">JUC工具类:CountDownLatch详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-tool-cyclicbarrier.html" class="sidebar-link">JUC工具类:CyclicBarrier详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-tool-semaphore.html" class="sidebar-link">JUC工具类:Semaphore详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-tool-phaser.html" class="sidebar-link">JUC工具类:Phaser详解</a></li><li><a href="/md/java/thread/java-thread-x-juc-tool-exchanger.html" class="sidebar-link">JUC工具类:Exchanger详解</a></li><li><a href="/md/java/thread/java-thread-x-threadlocal.html" class="sidebar-link">Java 并发 - ThreadLocal详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java IO/NIO/AIO</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/io/java-io-overview.html" class="sidebar-link">♥Java IO知识体系详解♥</a></li><li><a href="/md/java/io/java-io-basic-category.html" class="sidebar-link">Java IO - 分类(传输，操作)</a></li><li><a href="/md/java/io/java-io-basic-design-pattern.html" class="sidebar-link">Java IO - 设计模式(装饰者模式)</a></li><li><a href="/md/java/io/java-io-basic-code-inputstream.html" class="sidebar-link">Java IO - 源码:InputStream</a></li><li><a href="/md/java/io/java-io-basic-code-outputstream.html" class="sidebar-link">Java IO - 源码:OutputStream</a></li><li><a href="/md/java/io/java-io-basic-usage.html" class="sidebar-link">Java IO - 常见类使用</a></li><li><a href="/md/java/io/java-io-model.html" class="sidebar-link">IO 模型 - Unix IO 模型</a></li><li><a href="/md/java/io/java-io-bio.html" class="sidebar-link">Java IO - BIO 详解</a></li><li><a href="/md/java/io/java-io-nio.html" class="sidebar-link">Java NIO - 基础详解</a></li><li><a href="/md/java/io/java-io-nio-select-epoll.html" class="sidebar-link">Java NIO - IO多路复用详解</a></li><li><a href="/md/java/io/java-io-aio.html" class="sidebar-link">Java AIO - 异步IO详解</a></li><li><a href="/md/java/io/java-io-nio-netty.html" class="sidebar-link">Java N(A)IO - 框架:Netty</a></li><li><a href="/md/java/io/java-io-nio-zerocopy.html" class="sidebar-link">Java NIO - 零拷贝实现</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java8 特性详解</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/java8/java8.html" class="sidebar-link">♥Java8特性知识体系详解♥</a></li><li><a href="/md/java/java8/java8-stream.html" class="sidebar-link">Java 8 - 函数编程(lambda表达式)</a></li><li><a href="/md/java/java8/java8-optional.html" class="sidebar-link">Java 8 - Optional类深度解析</a></li><li><a href="/md/java/java8/java8-default.html" class="sidebar-link">Java 8 - 默认方法</a></li><li><a href="/md/java/java8/java8-type-anno.html" class="sidebar-link">Java 8 - 类型注解</a></li><li><a href="/md/java/java8/java8-anno-repeat.html" class="sidebar-link">Java 8 - 重复注解</a></li><li><a href="/md/java/java8/java8-type.html" class="sidebar-link">Java 8 - 类型推断优化</a></li><li><a href="/md/java/java8/java8-jre.html" class="sidebar-link">Java 8 - JRE精简</a></li><li><a href="/md/java/java8/java8-permgen.html" class="sidebar-link">Java 8 - 移除Permgen</a></li><li><a href="/md/java/java8/java8-stampedlock.html" class="sidebar-link">Java 8 - StampedLock</a></li><li><a href="/md/java/java8/java8-localdatetime.html" class="sidebar-link">Java 8 - LocalDate/LocalDateTime</a></li><li><a href="/md/java/java8/java8-javafx.html" class="sidebar-link">Java 8 - JavaFx 2.0</a></li><li><a href="/md/java/java8/java8-others.html" class="sidebar-link">Java 8 - 其它更新:字符串base64,...</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java8 以上特性概述</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/java8up/java-8-up-overview.html" class="sidebar-link">♥Java8+特性知识体系详解♥</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JVM相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/jvm/java-jvm-x-overview.html" class="sidebar-link">♥JVM相关知识体系详解♥</a></li><li><a href="/md/java/jvm/java-jvm-class.html" class="sidebar-link">JVM 基础 - 类字节码详解</a></li><li><a href="/md/java/jvm/java-jvm-class-enhancer.html" class="sidebar-link">JVM 基础 - 字节码的增强技术</a></li><li><a href="/md/java/jvm/java-jvm-classload.html" class="sidebar-link">JVM 基础 - Java 类加载机制</a></li><li><a href="/md/java/jvm/java-jvm-struct.html" class="sidebar-link">JVM 基础 - JVM 内存结构</a></li><li><a href="/md/java/jvm/java-jvm-x-introduce.html" aria-current="page" class="active sidebar-link">JVM 基础 - Java 内存模型引入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/md/java/jvm/java-jvm-jmm.html" class="sidebar-link">JVM 基础 - Java 内存模型详解</a></li><li><a href="/md/java/jvm/java-jvm-gc.html" class="sidebar-link">GC - Java 垃圾回收基础知识</a></li><li><a href="/md/java/jvm/java-jvm-gc-g1.html" class="sidebar-link">GC - Java 垃圾回收器之G1详解</a></li><li><a href="/md/java/jvm/java-jvm-gc-zgc.html" class="sidebar-link">GC - Java 垃圾回收器之ZGC详解</a></li><li><a href="/md/java/jvm/java-jvm-cms-gc.html" class="sidebar-link">GC - Java 垃圾回收器之CMS GC问题分析与解决</a></li><li><a href="/md/java/jvm/java-jvm-param.html" class="sidebar-link">调试排错 - JVM 调优参数</a></li><li><a href="/md/java/jvm/java-jvm-oom.html" class="sidebar-link">调试排错 - Java 内存分析之堆内存和MetaSpace内存</a></li><li><a href="/md/java/jvm/java-jvm-oom-offheap.html" class="sidebar-link">调试排错 - Java 内存分析之堆外内存</a></li><li><a href="/md/java/jvm/java-jvm-thread-dump.html" class="sidebar-link">调试排错 - Java 线程分析之线程Dump分析</a></li><li><a href="/md/java/jvm/java-jvm-debug-tools-linux.html" class="sidebar-link">调试排错 - Java 问题排查之Linux命令</a></li><li><a href="/md/java/jvm/java-jvm-debug-tools-list.html" class="sidebar-link">调试排错 - Java 问题排查之工具单</a></li><li><a href="/md/java/jvm/java-jvm-oom-tool.html" class="sidebar-link">调试排错 - Java 问题排查之JVM可视化工具</a></li><li><a href="/md/java/jvm/java-jvm-agent-arthas.html" class="sidebar-link">调试排错 - Java 问题排查之应用在线调试Arthas</a></li><li><a href="/md/java/jvm/java-jvm-debug-idea.html" class="sidebar-link">调试排错 - Java 问题排查之使用IDEA本地调试和远程调试</a></li><li><a href="/md/java/jvm/java-jvm-agent-usage.html" class="sidebar-link">调试排错 - Java动态调试技术原理</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jvm-基础-java-内存模型引入"><a href="#jvm-基础-java-内存模型引入" class="header-anchor">#</a> JVM 基础 - Java 内存模型引入</h1> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>很多人都无法区分Java内存模型和JVM内存结构，以及Java内存模型与物理内存之间的关系。本文从堆栈角度引入JMM，然后介绍JMM和物理内存之间的关系, 为后面<code>JMM详解</code>, <code>JVM 内存结构详解</code>, <code>Java 对象模型详解</code>等铺垫。 @123</p></div> <ul><li>JVM 基础 - Java 内存模型引入
<ul><li>JMM引入
<ul><li>从堆栈说起</li> <li>堆栈里面放了什么?</li> <li>线程栈如何访问堆上对象?</li> <li>线程栈访问堆示例</li></ul></li> <li>JMM与硬件内存结构关系
<ul><li>硬件内存结构简介</li> <li>JMM与硬件内存连接 - 引入</li> <li>JMM与硬件内存连接 - 对象共享后的可见性</li> <li>JMM与硬件内存连接 - 竞态条件</li></ul></li> <li>参考文章</li></ul></li></ul> <h3 id="jmm引入"><a href="#jmm引入" class="header-anchor">#</a> # JMM引入</h3> <h3 id="从堆栈说起"><a href="#从堆栈说起" class="header-anchor">#</a> # 从堆栈说起</h3> <blockquote><p>JVM内部使用的Java内存模型在线程栈和堆之间划分内存。 此图从逻辑角度说明了Java内存模型：</p></blockquote> <blockquote><p><img src="data:image/png;base64,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" alt=""></p></blockquote> <h3 id="堆栈里面放了什么"><a href="#堆栈里面放了什么" class="header-anchor">#</a> # 堆栈里面放了什么?</h3> <blockquote><p>线程堆栈还包含正在执行的每个方法的所有局部变量(调用堆栈上的所有方法)。 线程只能访问它自己的线程堆栈。 由线程创建的局部变量对于创建它的线程以外的所有其他线程是不可见的。 即使两个线程正在执行完全相同的代码，两个线程仍将在每个自己的线程堆栈中创建该代码的局部变量。 因此，每个线程都有自己的每个局部变量的版本。</p></blockquote> <blockquote><p>基本类型的所有局部变量(boolean，byte，short，char，int，long，float，double)完全存储在线程堆栈中，因此对其他线程不可见。 一个线程可以将一个基本类型变量的副本传递给另一个线程，但它不能共享原始局部变量本身。</p></blockquote> <blockquote><p>堆包含了在Java应用程序中创建的所有对象，无论创建该对象的线程是什么。 这包括基本类型的包装类(例如Byte，Integer，Long等)。 无论是创建对象并将其分配给局部变量，还是创建为另一个对象的成员变量，该对象仍然存储在堆上。</p></blockquote> <blockquote><p><img src="data:image/png;base64,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" alt=""></p></blockquote> <blockquote><p>局部变量可以是基本类型，在这种情况下，它完全保留在线程堆栈上。</p></blockquote> <blockquote><p>局部变量也可以是对象的引用。 在这种情况下，引用(局部变量)存储在线程堆栈中，但是对象本身存储在堆(Heap)上。</p></blockquote> <blockquote><p>对象的成员变量与对象本身一起存储在堆上。 当成员变量是基本类型时，以及它是对象的引用时都是如此。</p></blockquote> <blockquote><p>静态类变量也与类定义一起存储在堆上。</p></blockquote> <h3 id="线程栈如何访问堆上对象"><a href="#线程栈如何访问堆上对象" class="header-anchor">#</a> # 线程栈如何访问堆上对象?</h3> <blockquote><p>所有具有对象引用的线程都可以访问堆上的对象。 当一个线程有权访问一个对象时，它也可以访问该对象的成员变量。 如果两个线程同时在同一个对象上调用一个方法，它们都可以访问该对象的成员变量，但每个线程都有自己的局部变量副本。</p></blockquote> <blockquote><p><img src="data:image/png;base64,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" alt=""></p></blockquote> <blockquote><p>两个线程有一组局部变量。 其中一个局部变量(局部变量2)指向堆上的共享对象(对象3)。 两个线程各自对同一对象具有不同的引用。 它们的引用是局部变量，因此存储在每个线程的线程堆栈中(在每个线程堆栈上)。 但是，这两个不同的引用指向堆上的同一个对象。</p></blockquote> <blockquote><p>注意共享对象(对象3)如何将对象2和对象4作为成员变量引用(由对象3到对象2和对象4的箭头所示)。 通过对象3中的这些成员变量引用，两个线程可以访问对象2和对象4.</p></blockquote> <blockquote><p>该图还显示了一个局部变量，该变量指向堆上的两个不同对象。 在这种情况下，引用指向两个不同的对象(对象1和对象5)，而不是同一个对象。 理论上，如果两个线程都引用了两个对象，则两个线程都可以访问对象1和对象5。 但是在上图中，每个线程只引用了两个对象中的一个。</p></blockquote> <h3 id="线程栈访问堆示例"><a href="#线程栈访问堆示例" class="header-anchor">#</a> # 线程栈访问堆示例</h3> <blockquote><p>那么，什么样的Java代码可以导致上面的内存图? 好吧，代码就像下面的代码一样简单：</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>public class MyRunnable implements Runnable() {

    public void run() {
        methodOne();
    }

    public void methodOne() {
        int localVariable1 = 45;

        MySharedObject localVariable2 =
            MySharedObject.sharedInstance;

        //... do more with local variables.

        methodTwo();
    }

    public void methodTwo() {
        Integer localVariable1 = new Integer(99);

        //... do more with local variable.
    }
}

public class MySharedObject {

    //static variable pointing to instance of MySharedObject

    public static final MySharedObject sharedInstance =
        new MySharedObject();

    //member variables pointing to two objects on the heap

    public Integer object2 = new Integer(22);
    public Integer object4 = new Integer(44);

    public long member1 = 12345;
    public long member1 = 67890;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><blockquote><p>如果两个线程正在执行run()方法，则前面显示的图表将是结果。 run()方法调用methodOne()，methodOne()调用methodTwo()。</p></blockquote> <blockquote><p>methodOne()声明一个局部基本类型变量(类型为int的localVariable1)和一个局部变量，它是一个对象引用(localVariable2)。</p></blockquote> <blockquote><p>执行methodOne()的每个线程将在各自的线程堆栈上创建自己的localVariable1和localVariable2副本。 localVariable1变量将完全相互分离，只存在于每个线程的线程堆栈中。 一个线程无法看到另一个线程对其localVariable1副本所做的更改。</p></blockquote> <blockquote><p>执行methodOne()的每个线程也将创建自己的localVariable2副本。 但是，localVariable2的两个不同副本最终都指向堆上的同一个对象。 代码将localVariable2设置为指向静态变量引用的对象。 静态变量只有一个副本，此副本存储在堆上。 因此，localVariable2的两个副本最终都指向静态变量指向的MySharedObject的同一个实例。 MySharedObject实例也存储在堆上。 它对应于上图中的对象3。</p></blockquote> <blockquote><p>注意MySharedObject类还包含两个成员变量。 成员变量本身与对象一起存储在堆上。 两个成员变量指向另外两个Integer对象。 这些Integer对象对应于上图中的Object 2和Object 4。</p></blockquote> <blockquote><p>另请注意methodTwo()如何创建名为localVariable1的局部变量。 此局部变量是对Integer对象的对象引用。 该方法将localVariable1引用设置为指向新的Integer实例。 localVariable1引用将存储在执行methodTwo()的每个线程的一个副本中。 实例化的两个Integer对象将存储在堆上，但由于该方法每次执行该方法时都会创建一个新的Integer对象，因此执行此方法的两个线程将创建单独的Integer实例。 在methodTwo()中创建的Integer对象对应于上图中的Object 1和Object 5。</p></blockquote> <blockquote><p>另请注意类型为long的MySharedObject类中的两个成员变量，它们是基本类型。 由于这些变量是成员变量，因此它们仍与对象一起存储在堆上。 只有局部变量存储在线程堆栈中。</p></blockquote> <h3 id="jmm与硬件内存结构关系"><a href="#jmm与硬件内存结构关系" class="header-anchor">#</a> # JMM与硬件内存结构关系</h3> <h3 id="硬件内存结构简介"><a href="#硬件内存结构简介" class="header-anchor">#</a> # 硬件内存结构简介</h3> <blockquote><p>现代硬件内存架构与内部Java内存模型略有不同。 了解硬件内存架构也很重要，以了解Java内存模型如何与其一起工作。 本节介绍了常见的硬件内存架构，后面的部分将介绍Java内存模型如何与其配合使用。</p></blockquote> <blockquote><p>这是现代计算机硬件架构的简化图：</p></blockquote> <blockquote><p><img src="data:image/png;base64,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" alt=""></p></blockquote> <blockquote><p>现代计算机通常有2个或更多CPU。 其中一些CPU也可能有多个内核。 关键是，在具有2个或更多CPU的现代计算机上，可以同时运行多个线程。 每个CPU都能够在任何给定时间运行一个线程。 这意味着如果您的Java应用程序是多线程的，线程真的在可能同时运行.</p></blockquote> <blockquote><p>每个CPU基本上都包含一组在CPU内存中的寄存器。 CPU可以在这些寄存器上执行的操作比在主存储器中对变量执行的操作快得多。 这是因为CPU可以比访问主存储器更快地访问这些寄存器。</p></blockquote> <blockquote><p>每个CPU还可以具有CPU高速缓存存储器层。 事实上，大多数现代CPU都有一些大小的缓存存储层。 CPU可以比主存储器更快地访问其高速缓存存储器，但通常不会像访问其内部寄存器那样快。 因此，CPU高速缓存存储器介于内部寄存器和主存储器的速度之间。 某些CPU可能有多个缓存层(级别1和级别2)，但要了解Java内存模型如何与内存交互，这一点并不重要。 重要的是要知道CPU可以有某种缓存存储层。</p></blockquote> <blockquote><p>计算机还包含主存储区(RAM)。 所有CPU都可以访问主内存。 主存储区通常比CPU的高速缓存存储器大得多。同时访问速度也就较慢.</p></blockquote> <blockquote><p>通常，当CPU需要访问主存储器时，它会将部分主存储器读入其CPU缓存。 它甚至可以将部分缓存读入其内部寄存器，然后对其执行操作。 当CPU需要将结果写回主存储器时，它会将值从其内部寄存器刷新到高速缓冲存储器，并在某些时候将值刷新回主存储器。</p></blockquote> <h3 id="jmm与硬件内存连接-引入"><a href="#jmm与硬件内存连接-引入" class="header-anchor">#</a> # JMM与硬件内存连接 - 引入</h3> <blockquote><p>如前所述，Java内存模型和硬件内存架构是不同的。 硬件内存架构不区分线程堆栈和堆。 在硬件上，线程堆栈和堆都位于主存储器中。 线程堆栈和堆的一部分有时可能存在于CPU高速缓存和内部CPU寄存器中。 这在图中说明：</p></blockquote> <blockquote><p><img src="data:image/png;base64,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" alt=""></p></blockquote> <blockquote><p>当对象和变量可以存储在计算机的各种不同存储区域中时，可能会出现某些问题。 两个主要问题是：</p></blockquote> <ul><li>Visibility of thread updates (writes) to shared variables.</li> <li>Race conditions when reading, checking and writing shared variables. 以下各节将解释这两个问题。</li></ul> <h3 id="jmm与硬件内存连接-对象共享后的可见性"><a href="#jmm与硬件内存连接-对象共享后的可见性" class="header-anchor">#</a> # JMM与硬件内存连接 - 对象共享后的可见性</h3> <blockquote><p>如果两个或多个线程共享一个对象，而没有正确使用volatile声明或同步，则一个线程对共享对象的更新可能对其他线程不可见。</p></blockquote> <blockquote><p>想象一下，共享对象最初存储在主存储器中。 然后，在CPU上运行的线程将共享对象读入其CPU缓存中。 它在那里对共享对象进行了更改。 只要CPU缓存尚未刷新回主内存，共享对象的更改版本对于在其他CPU上运行的线程是不可见的。 这样，每个线程最终都可能拥有自己的共享对象副本，每个副本都位于不同的CPU缓存中。</p></blockquote> <blockquote><p>下图描绘了该情况。 在左CPU上运行的一个线程将共享对象复制到其CPU缓存中，并将其count变量更改为2.对于在右边的CPU上运行的其他线程，此更改不可见，因为计数更新尚未刷新回主内存中.</p></blockquote> <blockquote><p><img src="data:image/png;base64,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" alt=""></p></blockquote> <blockquote><p>要解决此问题，您可以使用Java的volatile关键字。 volatile关键字可以确保直接从主内存读取给定变量，并在更新时始终写回主内存。</p></blockquote> <h3 id="jmm与硬件内存连接-竞态条件"><a href="#jmm与硬件内存连接-竞态条件" class="header-anchor">#</a> # JMM与硬件内存连接 - 竞态条件</h3> <blockquote><p>如果两个或多个线程共享一个对象，并且多个线程更新该共享对象中的变量，则可能会出现竞态。</p></blockquote> <blockquote><p>想象一下，如果线程A将共享对象的变量计数读入其CPU缓存中。 想象一下，线程B也做同样的事情，但是进入不同的CPU缓存。 现在，线程A将一个添加到count，而线程B执行相同的操作。 现在var1已经增加了两次，每个CPU缓存一次。</p></blockquote> <blockquote><p>如果这些增量是按先后顺序执行的，则变量计数将增加两次并将原始值+ 2写回主存储器。</p></blockquote> <blockquote><p>但是，两个增量同时执行而没有适当的同步。 无论线程A和B中哪一个将其更新后的计数版本写回主存储器，更新的值将仅比原始值高1，尽管有两个增量。</p></blockquote> <blockquote><p>该图说明了如上所述的竞争条件问题的发生：</p></blockquote> <blockquote><p><img src="data:image/png;base64,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" alt=""></p></blockquote> <blockquote><p>要解决此问题，您可以使用Java synchronized块。 同步块保证在任何给定时间只有一个线程可以进入代码的给定关键部分。 同步块还保证在同步块内访问的所有变量都将从主存储器中读入，当线程退出同步块时，所有更新的变量将再次刷新回主存储器，无论变量是不是声明为volatile</p></blockquote> <h3 id="参考文章"><a href="#参考文章" class="header-anchor">#</a> # 参考文章</h3> <ul><li>http://tutorials.jenkov.com/java-concurrency/java-memory-model.html</li> <li>https://blog.csdn.net/weixin_39596082/article/details/88093274</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/14/2023, 10:10:22 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/md/java/jvm/java-jvm-struct.html" class="prev">
        JVM 基础 - JVM 内存结构
      </a></span> <span class="next"><a href="/md/java/jvm/java-jvm-jmm.html">
        JVM 基础 - Java 内存模型详解
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:290px;display:none;" data-v-5775ee02>
      欢迎来到我的博客
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="260px" height="320" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><canvas id="vuepress-canvas-cursor"></canvas><!----><div class="RibbonAnimation"></div><!----><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:2;" data-v-248d85d6></canvas></div></div></div>
    <script src="/assets/js/app.0d6df2e4.js" defer></script><script src="/assets/js/3.2c60df78.js" defer></script><script src="/assets/js/16.9a65883a.js" defer></script>
  </body>
</html>
